import nimcrypto


var 
  aliceKey = "Alice Key"
  encData = @[byte(49), 111, 19, 176, 148, 13, 0, 200, 154, 147, 199, 241, 221, 209, 4, 191, 214, 186, 182]
  aliceData = newSeq[byte](len(encData))
  aliceIV = "0123456789ABCDEF"
  dctx: CTR[aes256]
  key: array[aes256.sizeKey, byte]
  iv: array[aes256.sizeBlock, byte]

copyMem(addr key[0], addr aliceKey[0], len(aliceKey))
copyMem(addr iv[0], addr aliceIV[0], len(aliceIV))

dctx.init(key, iv)
dctx.decrypt(encData, aliceData)
dctx.clear()


echo "IV:                   ", toHex(iv)
echo "Plain Text (Hex):     416C6963652068696464656E20736563726574"
echo "Decrypted (Hex):      ", toHex(aliceData)
#echo "Plain Text:           ", plainText
#echo "Encrypted text:       ", encText
